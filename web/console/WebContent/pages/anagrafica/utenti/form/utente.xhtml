<!-- 
  ProxyFatturaPA - Gestione del formato Fattura Elettronica 
  http://www.gov4j.it/fatturapa
  
  Copyright (c) 2014-2015 Link.it srl (http://link.it). 
  Copyright (c) 2014-2015 Provincia Autonoma di Bolzano (http://www.provincia.bz.it/). 
  
  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 3 of the License, or
  (at your option) any later version.
 
  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.
 
  You should have received a copy of the GNU General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<ui:composition template="/templates/defaultTemplate.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:op2web="http://www.openspcoop2.org/web/taglib/jsf">
	<f:loadBundle var="msg" basename="messages" />

	<ui:define name="pageTitle">#{msg['utente.dettaglio.pageTitle']}</ui:define>
	<ui:define name="pageHeader">#{msg['utente.dettaglio.pageTitle']}</ui:define>
	<ui:define name="navbar">
		<ul>
			<li><h:outputText value="/#{msg['menu.group.anagrafica']}" /></li>
			<li><a4j:htmlCommandLink action="#{utenteMBean.restoreSearch}"
					value="/#{msg['utente.listaUtenti.pageTitle']}">
				</a4j:htmlCommandLink></li>
			<li><h:outputText
					rendered="#{utenteMBean.selectedElement.DTO.id != -1}"
					value="/#{msg['utente.dettaglio.pageTitle']} (#{utenteMBean.selectedElement.username.value})" /></li>
			<li><h:outputText
					rendered="#{utenteMBean.showForm == true and utenteMBean.azione == 'update'}"
					value="/#{msg['commons.button.aggiorna']}" /> <h:outputText
					rendered="#{utenteMBean.showForm == true and utenteMBean.azione != 'update'}"
					value="/#{msg['commons.button.nuovo']}" /></li>
		</ul>
	</ui:define>
	<ui:define name="body">

		<a4j:keepAlive beanName="utenteMBean" ajaxOnly="true" />

		<rich:panel id="panelContainer1" style="padding:0"
			headerClass="outpanelHeader" styleClass="noborder">
			<h:outputText id="outNoDettaglio"
				value="#{msg['utente.dettaglio.nodata']}"
				rendered="#{empty utenteMBean.selectedElement and utenteMBean.azione == 'update'}" />

			<!-- Form Inserimento dati -->
			<op2web:form formBean="#{utenteMBean.form}"
				rendered="#{utenteMBean.showForm  == true}">
				<p class="legend">
					<strong>#{msg['commons.label.note']}</strong> (<em>*</em>)
					#{msg['commons.label.campiObbligatori']}
				</p>
				<op2web:fieldset legend="#{msg['utente.form.label']}"
					collapsible="false" closed="false" rendered="#{true}">

					<!-- Nome -->
					<op2web:formField field="#{utenteMBean.form.nome}" />

					<!-- Cognome -->
					<op2web:formField field="#{utenteMBean.form.cognome}" />

					<!-- Username -->
					<op2web:formField field="#{utenteMBean.form.username}" />

					<!-- Password-->
					<op2web:formField field="#{utenteMBean.form.password}" />
					
					<!-- Ruolo-->
					<op2web:formField field="#{utenteMBean.form.ruolo}" />

				</op2web:fieldset>
				<br />

				<op2web:fieldset legend="#{msg['utente.form.dipartimento.label']}"
					collapsible="false" closed="false" rendered="#{true}">

					<!-- Dipartimento -->
					<op2web:formField field="#{utenteMBean.form.dipartimento}" />

				</op2web:fieldset>
				<ui:define name="buttons">
						<a4j:commandButton id="invia"
							value="#{msg['commons.button.invia']}" styleClass="icon-save"
							reRender="mainct,menuct" status="mainStatus"
							action="#{utenteMBean.invia}">
						</a4j:commandButton>

						<a4j:commandButton id="annulla" 
							value="#{msg['commons.button.annulla']}" status="mainStatus"
							styleClass="icon-delete" action="#{utenteMBean.annulla}"
							reRender="mainct,menuct">
						</a4j:commandButton>
				</ui:define>

			</op2web:form>

			<rich:panel id="panelDettaglio1" bodyClass="inpanelBody"
				rendered="#{not empty utenteMBean.selectedElement and utenteMBean.showForm == false}">
				<f:facet name="header">
					<h:outputText id="outHeaderFattura1"
						value="#{msg['utente.dettaglio.pageTitle']} (#{utenteMBean.selectedElement.username.value})"
						rendered="#{not empty utenteMBean.selectedElement}" />
				</f:facet>

				<!-- Messaggio Idp -->
				<h:panelGrid id="panelDettaglio2"
					columnClasses="gridContent verticalAlignTop"
					rendered="#{!empty utenteMBean.selectedElement}" columns="1"
					width="100%">

					<!-- Dati Generali  -->
					<op2web:fieldset legend="#{msg['utente.label.generale']}"
						rendered="#{true}">
						<op2web:outputGroup
							group="#{utenteMBean.selectedElement.fieldsDatiGenerali}" />
					</op2web:fieldset>
					
					<op2web:fieldset legend="#{msg['utente.form.dipartimento.label']}"
					collapsible="false" closed="false" rendered="#{not empty utenteMBean.selectedElement.listaDipartimenti}">
					
					<c:set var="dipartimentoMetadata"
							value="#{utenteMBean.selectedElement.metadataDipartimento}" />
							
					<c:set var="listaDipartimenti"
							value="#{utenteMBean.selectedElement.listaDipartimenti}" />
							
							<op2web:simpleTable id="tabellaDipartimenti"
							rendered="#{not empty listaDipartimenti}" value="#{listaDipartimenti}">
						<!-- Descrizione -->
						<op2web:tableColumn fieldValue="#{item.descrizione}"
							fieldDescriptor="#{dipartimentoMetadata.descrizione}" />
							
						<!-- Codice -->
						<op2web:tableColumn fieldValue="#{item.codice}"
							fieldDescriptor="#{dipartimentoMetadata.codice}" />

						<!-- Modalita' Push -->
						<op2web:tableColumn fieldValue="#{item.modalitaPush}"
							fieldDescriptor="#{dipartimentoMetadata.modalitaPush}" />

						</op2web:simpleTable>
					
					</op2web:fieldset>

				</h:panelGrid>

				<br />
				<h:form id="formShowUpdateForm">
					<div class="buttonrow">
						<a4j:commandButton id="aggiorna"
							value="#{msg['commons.button.modifica']}"
							styleClass="icon-edit" status="mainStatus"
							action="#{utenteMBean.modifica}" reRender="mainct,menuct">
						</a4j:commandButton>
					</div>
				</h:form>

			</rich:panel>

		</rich:panel>

	</ui:define>
</ui:composition>